# ðŸ“š Bertie's Books - Full Stack Bookstore Web Application

A complete Node.js + Express + MySQL web application developed for the Web Development coursework.  
The system implements full CRUD book management, a secure user registration & login system, audit logging, environment variable protection, and deployment using Forever.

---

# âœ… Table of Contents
1. [Project Overview](#project-overview)  
2. [Features](#features)  
3. [Technology Stack](#technology-stack)  
4. [Project Structure](#project-structure)  
5. [Installation & Setup](#installation--setup)  
6. [Database Setup](#database-setup)  
7. [User Authentication System](#user-authentication-system)  
8. [Audit Logging](#audit-logging)  
9. [Security with dotenv](#security-with-dotenv)  
10. [Default Login User (for marking)](#default-login-user-for-marking)  
11. [Deployment](#deployment)  
12. [Testing](#testing)  

---

# ðŸŽ¯ Project Overview
**Bertieâ€™s Books** is an online bookstore where users can:

- Browse books  
- Add new books  
- Search books (exact + partial match)  
- View bargain books (< Â£20)  
- Register an account  
- Log in securely using hashed passwords (bcrypt)  
- View login history in the Audit Log  
- Authenticate using a default user created for assessment  

This is the fully extended version of the coursework, implementing all tasks from A to D.

---

# âœ¨ Features

### ðŸ“˜ **Books**
- List all books  
- Add books  
- Search books (SQL LIKE)  
- Bargain books page  
- Fully styled EJS views  

### ðŸ‘¤ **User System**
- User registration with hashed passwords  
- Secure login  
- Prevents login with incorrect credentials  
- Login success/fail audit logging  

### ðŸ“Š **Audit System**
- Stores every login attempt  
- Shows: username, status, timestamp  
- Accessible at  /users/audit

### ðŸ” **Security Enhancements**
- MySQL credentials stored in `.env` file  
- Not included in GitHub (added to .gitignore)  
- Uses bcrypt with salt for password hashing  

### ðŸ§ª **Includes Default Assessor Account**
Created automatically using `insert_test_data.sql`:username: gold
password: smiths
---

# ðŸ› ï¸ Technology Stack

| Component | Technology |
|----------|------------|
| Backend | Node.js (Express.js) |
| Frontend | EJS templates, CSS |
| Database | MySQL (mysql2 driver) |
| Security | bcrypt, dotenv |
| Deployment | Forever on Ubuntu VM |
| Version Control | Git + GitHub |

---

# ðŸ“‚ Project Structure
project/
â”‚â”€â”€ index.js
â”‚â”€â”€ db.js
â”‚â”€â”€ package.json
â”‚â”€â”€ .env
â”‚â”€â”€ insert_test_data.sql
â”‚
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ main.js
â”‚   â”œâ”€â”€ books.js
â”‚   â””â”€â”€ users.js
â”‚
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ index.ejs
â”‚   â”œâ”€â”€ about.ejs
â”‚   â”œâ”€â”€ login.ejs
â”‚   â”œâ”€â”€ register.ejs
â”‚   â”œâ”€â”€ audit.ejs
â”‚   â”œâ”€â”€ listusers.ejs
â”‚   â”œâ”€â”€ addbook.ejs
â”‚   â”œâ”€â”€ list.ejs
â”‚   â”œâ”€â”€ search.ejs
â”‚   â””â”€â”€ searchresult.ejs
â”‚
â””â”€â”€ public/
â””â”€â”€ main.css
---

# ðŸš€ Installation & Setup

## 1. Install dependencies
```bash
npm install
2. Create .env file
DB_HOST=localhost
DB_USER=berties_books_app
DB_PASSWORD=qwertyuiop
DB_NAME=berties_books

3. Run the SQL setup
mysql -u root -p < create_tables.sql
mysql -u root -p < insert_test_data.sql

4. Start the server
node index.js
Application runs at:http://localhost:8000

 Database Setup

âœ” Tables included:
	â€¢	users
	â€¢	books
	â€¢	audit_log

âœ” Password hashing

All passwords are stored using bcrypt with saltRounds = 10.

â¸»

ðŸ” User Authentication System

âœ” Registration
	â€¢	Saves username, first name, last name, email, hashed password
	â€¢	Rejects missing fields
	â€¢	Shows confirmation message

âœ” Login
	â€¢	Selects hashed password from DB
	â€¢	Compares using:bcrypt.compare(password, hashedPassword)
    â€¢	On success: friendly welcome
	â€¢	On failure: warning message


    ðŸ“Š Audit Logging

Every login attempt is logged:
Column
Description
username
typed username
status
success / fail
timestamp
auto-filled

Security With dotenv

Why?

Database credentials must not be visible in GitHub.

How it works:
	1.	Installed dependency:npm install dotenv
    2.	Added to index.js:require('dotenv').config();
    3.	Moved credentials to .env
	4.	.env added to .gitignore



     Testing Checklist

ðŸ”¹ Books
	â€¢	Add a book
	â€¢	View book list
	â€¢	Search:
	â€¢	exact
	â€¢	partial
	â€¢	Bargain books (< Â£20)

ðŸ”¹ Users
	â€¢	Register new user
	â€¢	Login with correct password
	â€¢	Fail login intentionally

ðŸ”¹ Audit
	â€¢	Confirm login attempts appear in /users/audit

ðŸ”¹ Default User
	â€¢	Login using gold / smiths
